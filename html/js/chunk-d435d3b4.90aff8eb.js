(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d435d3b4"],{"954e":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"one-table"},[a("actions",{staticClass:"actions",attrs:{options:e.actionsOptions},on:{add:e.add,edit:e.edit,refresh:e.refresh,remove:e.remove}}),a("div",{staticClass:"data-table"},[a("ag-grid",{staticClass:"ag-theme-material",staticStyle:{width:"100%",height:"100%"},attrs:{gridOptions:e.gridOptions}})],1),a("edit-modal",{ref:"editModal",attrs:{loading:e.editModal.loading},on:{cancel:e.cancel,ok:e.ok}},[a("Form",{ref:"editModalForm",attrs:{"label-width":80,model:e.editModal.data,rules:e.editModal.rules}},[a("FormItem",{attrs:{label:e.$t("system.dictionary.groupCode"),prop:"groupCode"}},[a("Input",{attrs:{placeholder:e.$t("common.rules.plsInput")},model:{value:e.editModal.data.groupCode,callback:function(t){e.$set(e.editModal.data,"groupCode",t)},expression:"editModal.data.groupCode"}})],1),a("FormItem",{attrs:{label:e.$t("system.dictionary.label"),prop:"label"}},[a("Input",{attrs:{placeholder:e.$t("common.rules.plsInput")},model:{value:e.editModal.data.label,callback:function(t){e.$set(e.editModal.data,"label",t)},expression:"editModal.data.label"}})],1),a("FormItem",{attrs:{label:e.$t("system.dictionary.value"),prop:"value"}},[a("Input",{attrs:{placeholder:e.$t("common.rules.plsInput")},model:{value:e.editModal.data.value,callback:function(t){e.$set(e.editModal.data,"value",t)},expression:"editModal.data.value"}})],1),a("FormItem",{attrs:{label:e.$t("system.dictionary.orderNo"),prop:"orderNo"}},[a("InputNumber",{staticStyle:{width:"100%"},attrs:{min:0},model:{value:e.editModal.data.orderNo,callback:function(t){e.$set(e.editModal.data,"orderNo",t)},expression:"editModal.data.orderNo"}})],1),a("FormItem",{attrs:{label:e.$t("common.labels.description"),prop:"description"}},[a("Input",{attrs:{autosize:{minRows:2,maxRows:5},placeholder:e.$t("common.rules.plsInput"),type:"textarea"},model:{value:e.editModal.data.description,callback:function(t){e.$set(e.editModal.data,"description",t)},expression:"editModal.data.description"}})],1)],1)],1)],1)},r=[],o=(a("8e6e"),a("ac6a"),a("456d"),a("ade3")),d=(a("96cf"),a("1da1")),s=a("6689"),l=a("e7f7"),n=a("3595"),c=a("ccdb"),u=a("2211"),m=a("083f"),p=a("9b95"),g=a("8eac");function h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function f(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?h(Object(a),!0).forEach((function(t){Object(o["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var b={name:"data-dictionary",components:{actions:p["a"],editModal:g["a"]},mixins:[l["a"]],data:function(){var e=this,t=function(){var t=Object(d["a"])(regeneratorRuntime.mark((function t(a,i,r){var o,d,l,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$regex.commonUse().test(e.editModal.data.groupCode)){t.next=4;break}r(new Error(e.$t("validate.commonUse.infinite",{name:e.$t("system.dictionary.value")}))),t.next=14;break;case 4:if(e.$_.isEmpty(e.$_.trim(e.editModal.data.groupCode))){t.next=13;break}return o=e.editModal.data.id||null,d=e.editModal.data.groupCode,l=e.$t("system.dictionary.messages.uniqueGroupCodeAndValue",{groupCode:d,value:i}),n={id_not:o,groupCode:d,value:i},t.next=11,Object(m["a"])(s["client"],"DataDictionary",n,r,l);case 11:t.next=14;break;case 13:r();case 14:case"end":return t.stop()}}),t)})));return function(e,a,i){return t.apply(this,arguments)}}();return{gridOptions:this.$_.assign(this.$agGetDefaultGridOptions(),{onGridReady:this.gridReady.bind(this),onSelectionChanged:this.selectionChanged.bind(this),pagination:!0,columnDefs:[{type:["rowNumberColumn"]},{headerName:this.$t("system.dictionary.groupCode"),field:"groupCode",filter:"agTextColumnFilter"},{headerName:this.$t("system.dictionary.label"),field:"label"},{headerName:this.$t("system.dictionary.value"),field:"value",cellRendererFramework:c["a"]},{headerName:this.$t("system.dictionary.orderNo"),field:"orderNo",filter:"agNumberColumnFilter"},{headerName:this.$t("common.labels.createdAt"),field:"createdAt",cellRendererFramework:n["a"],width:200,filter:"agDateColumnFilter"},{headerName:this.$t("common.labels.updatedAt"),cellRendererFramework:n["a"],field:"updatedAt",filter:"agDateColumnFilter",width:200,sort:"desc"},{headerName:this.$t("common.labels.description"),field:"description",filter:"agTextColumnFilter"}]}),gridApi:null,columnApi:null,editModal:{loading:!1,visible:!1,data:this.getDefaultData(),rules:{groupCode:[{required:!0,message:this.$t("common.rules.plsInput"),trigger:"blur"},{validator:function(t,a,i){e.$regex.commonUse().test(a)?i():i(new Error(e.$t("validate.commonUse.infinite",{name:e.$t("system.dictionary.groupCode")})))},trigger:"change"}],label:[{required:!0,message:this.$t("common.rules.plsInput"),trigger:"blur"},{validator:function(t,a,i){e.$regex.nameReg.test(a)?i():i(new Error(e.$t("validate.nameReg",{name:e.$t("system.dictionary.label")})))}}],value:[{required:!0,message:this.$t("common.rules.plsInput"),trigger:"blur"},{validator:t,trigger:"blur"}],orderNo:[{required:!0,type:"number",trigger:"blur",message:this.$t("common.rules.plsInput")}],description:[{message:this.$t("common.rules.plsInput")},{validator:function(t,a,i){e.$regex.special.test(a)?i(new Error(e.$t("validate.special"))):i()},trigger:"change"}]}},actionsOptions:{edit:{visible:!0,disabled:!0},remove:{visible:!0,disabled:!0}},isAllowDefaultSelected:!0}},methods:{gridReady:function(e){this.gridApi=e.api,this.columnApi=e.columnApi,this.gridApi.sizeColumnsToFit(),e.api.setServerSideDatasource(this.serverSideDatasource())},selectionChanged:function(e){var t=e.api.getSelectedRows();this.actionsOptions.remove.disabled=this.actionsOptions.edit.disabled=!(t&&t.length>0)},getDefaultData:function(){return{groupCode:"",label:"",value:"",description:"",orderNo:0}},add:function(){this.editModal.data=this.getDefaultData(),this.$refs.editModalForm.resetFields(),this.editModal.loading=!1,this.$refs.editModal.open()},edit:function(){this.$refs.editModalForm.resetFields();var e=this.getSelectedNode();e?(this.editModal.data=f({},e.data),this.editModal.loading=!1,this.$refs.editModal.open(!0)):this.$Message.warning(this.$t("common.messages.plsSelectRow"))},cancel:function(){!0!==this.editModal.loading&&(this.editModal.data=this.getDefaultData(),this.editModal.loading=!1,this.$refs.editModal.close())},ok:function(){var e=this;this.editModal.loading=!0,this.$refs.editModalForm.validate((function(t){if(t){var a=e.editModal.data,i=a.id,r=a.groupCode,o=a.label,d=a.value,l=a.orderNo,n=a.description,c={groupCode:r,label:o,value:d,orderNo:l,description:n},m={where:{id:i||"undefined"},create:c,update:c};e.$apollo.mutate({mutation:u["c"],variables:m,client:s["client"]}).then((function(t){if(i){var a=e.getSelectedNode();a.setData(Object.assign(a.data,f({},t.data.node)))}else e.gridApi.setSortModel([{colId:"createdAt",sort:"desc"}]);e.$refs.editModal.close(),e.editModal.loading=!1,e.$Message.success(e.$t("common.messages.saveSuccess"))})).catch((function(){e.editModal.loading=!1,e.$Message.error(e.$t("common.messages.saveFailure"))}))}else e.editModal.loading=!1,e.$Message.error(e.$t("common.rules.validateFailure"))}))},getSelectedNode:function(){var e=this.gridApi.getSelectedNodes();return e&&e.length>0&&e[0]&&e[0].id?e[0]:null},remove:function(){var e=this,t=this.getSelectedNode();if(t){var a=t.id;this.$apollo.mutate({mutation:u["b"],variables:{id:a},client:s["client"]}).then((function(){e.gridApi.deselectAll(),e.gridApi.purgeServerSideCache(),e.$Message.success(e.$t("common.messages.removeSuccess"))})).catch((function(){e.$Message.error(e.$t("common.messages.removeFailure"))}))}else this.$Message.warning(this.$t("common.messages.plsSelectRow"))},refresh:function(){this.gridApi.purgeServerSideCache()},serverSideDatasource:function(){var e=this;return{getRows:function(t){var a=t.request,i={skip:a.startRow,first:a.endRow-a.startRow};i.orderBy=e.$agGenerateOrderByFromSortModel(a.sortModel);var r=e.$agGenerateWhereFromFiltersModel(t.request.filterModel);i.where=r,e.$apollo.query({query:u["a"],variables:i,client:s["client"]}).then((function(a){var i=a.data;t.successCallback(i.list,i.total.aggregate.count);var r=e.gridApi.getSelectedNodes();if(e.isAllowDefaultSelected)if(r.length>0)for(var o=0;o<i.list.length;o++)i.list[o].id!=r[0].id&&e.gridApi.getRenderedNodes()[0].setSelected(!0);else e.gridApi.getRenderedNodes()[0].setSelected(!0);else r.length>0&&e.deselectAll()}))}}}}},v=b,$=(a("f6f1"),a("2877")),M=Object($["a"])(v,i,r,!1,null,"4f123a18",null);t["default"]=M.exports},f6f1:function(e,t,a){"use strict";var i=a("f80c"),r=a.n(i);r.a},f80c:function(e,t,a){}}]);