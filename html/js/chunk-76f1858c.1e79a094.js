(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-76f1858c","chunk-2d0cfeb7"],{"20f0":function(e,t,r){"use strict";r.r(t);r("ac6a"),r("ac4d"),r("8a81"),r("5df3"),r("1c4c"),r("6b54"),r("96cf");var s=r("1da1"),i=(r("7f7f"),r("6689")),n=r("c9e5"),o=r("91f5"),a=r("f88e"),d=r("a250"),l=r("8eac"),u=r("70af"),c=r("7638");function f(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=m(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var s=0,i=function(){};return{s:i,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,n=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw n}}}}function m(e,t){if(e){if("string"===typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}var p={id:"",code:"",name:""},g="adminGroup";t["default"]={name:"user-group",components:{flexPanel:d["a"],actions:a["a"],editModal:l["a"]},mixins:[u["validMixins"]],apollo:{userGroups:{query:n["e"],client:i["client"],manual:!0,result:function(e){var t=this,r=e.data;if(this.userGroups=r.userGroups,this.userGroups.length>0){var s=this.selected;if(s){var i,n=f(this.userGroups);try{for(n.s();!(i=n.n()).done;){var o=i.value;o.id===s.id&&(s=o)}}catch(a){n.e(a)}finally{n.f()}}else s=this.userGroups[0];this.formModel=Object.assign({},s),this.$nextTick().then((function(){t.$emit("changed",Object.assign({},s),t.selected),t.selected=s}))}}}},props:{isActive:Boolean},data:function(){var e=this,t=function(t,r,s){var i=e.$_.trim(e.formModel.code);e.$_.isEmpty(i)?s():e.uniqueCodeValidate(s,e.formModel.code,e.formModel.id)},r=function(t,r,s){var i=e.$_.trim(e.formModel.name);e.$regex.nameReg.test(i)?e.uniqueNameValidate(s,e.formModel.name,e.formModel.id):s(new Error(e.$t("validate.nameReg",{name:e.$t("system.workStation.name")})))};return{userGroups:[],selected:null,isAdd:!1,isSubmit:!1,formModel:Object.assign({},p),rules:{code:[{required:!0,pattern:/^[a-zA-Z0-9\-_]{4,10}$/,message:this.$t("system.usergroup.messages.codeRule"),trigger:"blur"},{validator:t,trigger:"blur"}],name:[{required:!0,message:this.$t("system.usergroup.messages.nameRule"),trigger:"blur"},{validator:r,trigger:"blur"}]},actionsOptions:{add:{visible:!0,disabled:!1,loading:!1},edit:{visible:!0,disabled:!1},remove:{visible:!0,disabled:!0},resetPassword:{visible:!0,disabled:!0}}}},methods:{popperShow:function(e){var t=document.getElementsByClassName("permission-poptip-cls"),r=t&&t[e],s=r&&window.getComputedStyle(r);r.style.overflowY="auto",r.style.backgroundColor="white";var i=s&&parseInt(s.top);r.style.height=document.body.clientHeight-i+"px"},userGroupsClick:function(e){var t,r=this.selected,s=f(this.userGroups);try{for(s.s();!(t=s.n()).done;){var i=t.value;if(i.id===e){this.$refs.form.resetFields();var n=null===this.selected||this.selected.id!==e,o=i;return this.selected=o,this.formModel=Object.assign({},o),!0===n&&this.$emit("changed",Object.assign({},o),Object.assign({},r)),void(this.selected&&"adminGroup"===this.selected.code?(this.actionsOptions.remove.disabled=!0,this.actionsOptions.edit.disabled=!0):(this.actionsOptions.remove.disabled=!1,this.actionsOptions.edit.disabled=!1))}}}catch(a){s.e(a)}finally{s.f()}},remove:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,r,s,a,d=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={value:this.selected.code},e.next=3,Object(o["e"])(t);case 3:if(r=e.sent,s=r.list.length,!(s>0)){e.next=8;break}return this.$Message.warning(this.$t("common.messages.dataIntegrityError")),e.abrupt("return");case 8:if(this.selected&&this.selected.id){e.next=11;break}return this.$Message.warning(this.$t("common.messages.plsSelectRow")),e.abrupt("return");case 11:if(!(this.selected.users&&this.selected.users.length>0)){e.next=14;break}return this.$Message.warning(this.$t("system.usergroup.hasUsers",{count:this.selected.users.length})),e.abrupt("return");case 14:a={id:this.selected.id},this.$apollo.mutate({mutation:n["c"],variables:{where:a},client:i["client"]}).then((function(){d.refresh(),d.$Message.success(d.$t("common.messages.removeSuccess"))})).catch((function(){d.$Message.error(d.$t("common.messages.removeFailure"))}));case 16:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),refresh:function(){this.$refs.form.resetFields(),this.selected=null,this.formModel=Object.assign({},p),this.$apollo.queries.userGroups.refetch()},create:function(){this.$refs.form.resetFields(),this.selected=null,this.isAdd=!1,this.formModel=Object.assign({},p),this.$refs.editModal.open()},modify:function(){this.isAdd=!0,this.$refs.editModal.open(!0)},reset:function(){this.$refs.form.resetFields(),this.isAdd=!1,this.formModel=Object.assign({},this.selected||p),this.$refs.editModal.close()},upsert:function(){var e=this,t=!this.formModel.id;this.isSubmit=!0,this.$refs.form.validate((function(r){if(!r)return e.$Message.error(e.$t("common.rules.validateFailure")),void(e.isSubmit=!1);var s=e.formModel.id?{id:e.formModel.id}:{code:e.formModel.code},i={code:e.formModel.code,name:e.formModel.name,description:e.formModel.description};e.$apollo.mutate({mutation:n["d"],variables:{where:s,create:i,update:i}}).then((function(r){!0===t?e.refresh(r.data.node.id):(Object.assign(e.selected,r.data.node),e.$apollo.queries.userGroups.refetch()),e.$refs.editModal.close(),e.isAdd=!1,e.$Message.success(e.$t("common.messages.saveSuccess")),setTimeout((function(){e.isSubmit=!1}),1e3)})).catch((function(){e.isAdd=!0,e.$Message.error(e.$t("common.messages.saveFailure"))}))}))},uniqueCodeValidate:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,r){var s,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=i.length>2&&void 0!==i[2]?i[2]:"",e.next=3,this.validUnique({propName:"code",propVal:r,id:s,moduleName:c["e"].UserGroup},t);case 3:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}(),uniqueNameValidate:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,r){var s,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=i.length>2&&void 0!==i[2]?i[2]:"",e.next=3,this.validUnique({propName:"name",propVal:r,id:s,moduleName:c["e"].UserGroup},t);case 3:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}(),disRemove:function(){var e=this.selected;return!(e&&e.id&&e.code!==g)},disEdit:function(){var e=this.selected;if(e&&e.code===g)return!0}}}},5129:function(e,t,r){"use strict";var s=r("8917"),i=r.n(s);i.a},6689:function(e,t,r){"use strict";r.r(t),r.d(t,"client",(function(){return s}));var s="system"},8917:function(e,t,r){},a250:function(e,t,r){"use strict";var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Card",{staticClass:"flex-panel",attrs:{border:e.border,"dis-hover":e.disHover,icon:e.icon,padding:0,shadow:e.shadow,title:e.title}},[e.hideHeader?e._e():e._t("title",null,{slot:"title"}),e.hideHeader?e._e():e._t("extra",null,{slot:"extra"}),r("div",{staticClass:"flex-panel-body",style:{padding:e.padding+"px"}},[e._t("default")],2),e.hideFooter?e._e():r("div",{staticClass:"flex-panel-footer"},[e._t("footer")],2)],2)},i=[],n=(r("c5f6"),{name:"flex-panel",props:{border:{type:Boolean,default:!0},disHover:{type:Boolean,default:!1},shadow:{type:Boolean,default:!1},padding:{type:Number,default:16},icon:{type:String,default:""},title:{type:String,default:""},hideFooter:{type:Boolean,default:!1},hideHeader:{type:Boolean,default:!1}}}),o=n,a=(r("5129"),r("2877")),d=Object(a["a"])(o,s,i,!1,null,"7989b626",null),l=d.exports;t["a"]=l}}]);