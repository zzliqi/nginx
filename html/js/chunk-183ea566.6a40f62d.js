(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-183ea566"],{"5c97":function(e,t,n){},7638:function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"g",(function(){return r})),n.d(t,"i",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u}));var i="SECTOR_TYPE",a="Inv",r="PRINTER",o={edit:"edit",add:"add"},s={name:100,enterprise:2,site:2,area:4,sector:4,location:6,workCenter:20,workStation:20},c={area:"area",sector:"sector",location:"location"},d={Enterprise:"Enterprise",Site:"Site",Area:"Area",Sector:"Sector",Location:"Location",WorkCenter:"WorkCenter",WorkStation:"WorkStation",Device:"Device",AppCodeRule:"AppCodeRule",CodeInfo:"CodeInfo",UserGroup:"UserGroup",SignatureRule:"SignatureRule",MFGInstruction:"MFGInstruction"},l="XX[YYYY][MM][####]",u="MAX"},"7d9e":function(e,t,n){"use strict";var i=n("5c97"),a=n.n(i);a.a},"8eac":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{ref:"modal",attrs:{closable:!1,"mask-closable":!1,width:e.modalWidth},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[n("p",{attrs:{slot:"header"},slot:"header"},[n("Icon",{attrs:{type:e.icon}}),n("span",[e._v(e._s(e.title))])],1),e._t("default"),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{disabled:e.loading},on:{click:e.cancelEvent}},[e._v("\n      "+e._s(e.canceltext)+"\n    ")]),e.isOk?n("Button",{attrs:{loading:e.loading,type:"primary"},on:{click:e.okEvent}},[e._v(e._s(e.$t("common.buttons.ok")))]):e._e()],1)],2)},a=[],r=(n("c5f6"),{name:"edit-modal",props:{value:{type:Boolean,default:!1},isAdding:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},modalWidth:{type:Number,default:520},subtitle:{type:String,default:""},isOk:{type:Boolean,default:!0},subIcon:{type:String,default:""},subCanceltext:{type:String,default:""}},data:function(){return{icon:this.subIcon||"md-create",title:this.subtitle||this.$t("common.actions.edit"),visible:this.value,editing:!this.isAdding,canceltext:this.subCanceltext||this.$t("common.buttons.cancel")}},methods:{cancelEvent:function(){this.$emit("cancel")},okEvent:function(){this.$emit("ok")},open:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.editing=e,this.icon=!0===e?"md-create":"md-add",this.title=this.subtitle?this.subtitle:!0===e?this.$t("common.actions.edit")+this.subtitle:this.$t("common.actions.add")+this.subtitle,this.visible=!0},close:function(){this.visible=!1,this.icon="md-create",this.title=this.$t("common.actions.edit"),this.editing=!1},scrollTop:function(){var e=this.$refs.modal.$el,t=e.getElementsByClassName("ivu-modal-body");if(t&&t.length>0){var n=t[0];n&&n.scroll&&this.$nextTick((function(){return n.scroll(0,0)}))}}},watch:{value:function(e){this.visible=e,this.title=this.subtitle},visible:function(e){!0===e&&this.scrollTop()},subtitle:function(e){this.title=e}}}),o=r,s=(n("7d9e"),n("2877")),c=Object(s["a"])(o,i,a,!1,null,"0f32854a",null),d=c.exports;t["a"]=d},a9c4:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Select",e._b({attrs:{clearable:e.clearable,disabled:e.disabled,items:e.items,multiple:e.multiple,readonly:e.readonly,value:e.value},on:{"on-change":e.change,input:function(t){return e.$emit("input",t)}}},"Select",e.props,!1),e._l(e.items,(function(t){return n("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.text))])})),1)},a=[],r=(n("20d6"),n("ac6a"),n("456d"),n("53ca")),o={name:"select-enums",props:{typeName:{type:String,required:!0},value:{type:[String,Array],default:"",required:!1},filterProps:{type:Array,default:function(){return[]}},label:{type:String,default:""},disabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},props:{type:Object,default:function(){return{}}}},data:function(){return{items:[]}},mounted:function(){this.getItems(this.typeName)},methods:{getItems:function(e){var t=this;if(this.items=[],e){var n="schema.enums.".concat(e),i=this.$te(n);if(i){var a=this.$t(n);if("object"===Object(r["a"])(a))for(var o=function(){var e=c[s];if(t.filterProps.length&&-1===t.filterProps.findIndex((function(t){return t===e})))return"continue";t.items.push({text:a[e],value:e})},s=0,c=Object.keys(a);s<c.length;s++)o()}}},change:function(e){this.$emit("change",e)}}},s=o,c=n("2877"),d=Object(c["a"])(s,i,a,!1,null,null,null),l=d.exports;t["a"]=l},bf7a:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("edit-modal",{ref:"editModal",staticClass:"custom-width",attrs:{isAdding:e.isAdding,loading:e.okLoading,modalWidth:996},on:{cancel:e.cancel,ok:e.ok}},[n("Form",{ref:"editModalForm",attrs:{"label-width":85,model:e.editModal,rules:e.rules}},[n("Row",[n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:e.$t("product.factory.code"),prop:"code"}},[n("Input",{attrs:{disabled:e.codeDisabled,placeholder:e.$t("common.placeholders.plsInput")+e.$t("product.factory.code")},model:{value:e.editModal.code,callback:function(t){e.$set(e.editModal,"code",t)},expression:"editModal.code"}})],1)],1),n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{error:e.uniqueNameMessage,label:e.$t("product.factory.name"),prop:"name"}},[n("Input",{attrs:{placeholder:e.$t("common.placeholders.plsInput")+e.$t("product.factory.name")},on:{"on-change":e.deviceTypeChange},model:{value:e.editModal.name,callback:function(t){e.$set(e.editModal,"name",t)},expression:"editModal.name"}})],1)],1)],1),n("Row",[n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:e.$t("product.factory.device.type"),prop:"deviceType"}},[n("select-enums",{attrs:{placeholder:e.$t("common.placeholders.plsSelect")+e.$t("product.factory.device.type"),typeName:"DeviceType"},on:{change:e.deviceTypeChange},model:{value:e.editModal.deviceType,callback:function(t){e.$set(e.editModal,"deviceType",t)},expression:"editModal.deviceType"}})],1)],1),n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:e.$t("product.factory.device.status"),prop:"status"}},[n("select-enums",{attrs:{placeholder:e.$t("common.placeholders.plsSelect")+e.$t("product.factory.device.status"),typeName:"DeviceStatus"},model:{value:e.editModal.status,callback:function(t){e.$set(e.editModal,"status",t)},expression:"editModal.status"}})],1)],1)],1),n("Row",[n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:e.$t("product.factory.device.address"),prop:"address"}},[n("Input",{attrs:{placeholder:e.$t("common.placeholders.plsInput")+e.$t("product.factory.device.address")},model:{value:e.editModal.address,callback:function(t){e.$set(e.editModal,"address",t)},expression:"editModal.address"}})],1)],1),n("Col",{attrs:{span:"12"}},[n("FormItem",{attrs:{label:e.$t("product.factory.workStation.title"),prop:"workStation"}},[n("work-station-table",{attrs:{isSingleSelect:!1,readonly:!0,selected:e.workStationSelected},on:{change:function(t){return e.workStationTableChange(t)}}})],1)],1)],1),n("Row",[n("Col",{attrs:{span:"24"}},[n("FormItem",{attrs:{label:e.$t("product.factory.device.description"),prop:"description"}},[n("Input",{attrs:{placeholder:e.$t("common.placeholders.plsInput")+e.$t("product.factory.device.description"),type:"textarea"},model:{value:e.editModal.description,callback:function(t){e.$set(e.editModal,"description",t)},expression:"editModal.description"}})],1)],1)],1)],1)],1)],1)},a=[],r=(n("20d6"),n("7f7f"),n("96cf"),n("1da1")),o=n("8eac"),s=n("969c"),c=n("7638"),d=n("a9c4"),l=n("0644"),u=n.n(l),p=n("70af"),m=n("f121"),h=n("3b8e"),f={name:"upsert-device",inheritAttrs:!1,mixins:[p["validMixins"]],props:{icon:{type:String},title:{type:String},isAdding:{type:Boolean,default:!0},item:{type:Object,default:function(){return{}}}},components:{editModal:o["a"],selectEnums:d["a"],workStationTable:h["d"]},data:function(){var e=this;return{bakItem:this.item&&u()(this.item),editModal:this.item||{workStation:[]},rules:{code:[{required:!0,message:this.$t("common.rules.plsInput")+this.$t("product.supplier.code")},{trigger:"blur",validator:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n,i,a){var r,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.editModal.code,o=e.validCodeLength({val:r,min:1,max:c["a"].workStation}),"string"!==typeof o){t.next=5;break}return a(o),t.abrupt("return");case 5:if(s=e.validCodeCharacter(r),"string"!==typeof s){t.next=9;break}return a(s),t.abrupt("return");case 9:return t.next=11,e.uniqueIdValid(a);case 11:case"end":return t.stop()}}),t)})));function n(e,n,i){return t.apply(this,arguments)}return n}()}],address:[{required:!0,message:this.$t("common.rules.plsInput")}],deviceType:[{required:!0,message:this.$t("common.rules.plsSelect")}],status:[{required:!0,message:this.$t("common.rules.plsSelect")}]},workStationSelected:[]}},computed:{codeDisabled:function(){return!this.isAdding}},mounted:function(){this.workStationSelected=this.editModal.workStation,this.$refs.editModal.open(!this.isAdding)},methods:{workStationTableChange:function(e){this.editModal.workStation=e,this.workStationSelected=e},switchNameRules:function(){var e=this.editModal.name,t=this.validNameLength({val:e,min:1,max:c["a"].name});if("string"===typeof t)return this.uniqueNameFlag=!1,this.uniqueNameMessage=t,!1;var n=this.validNameCharacter(e);return"string"===typeof n?(this.uniqueNameFlag=!1,this.uniqueNameMessage=n,!1):(this.uniqueNameFlag=!0,this.uniqueNameMessage="",!0)},deviceTypeChange:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,i,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.editModal.deviceType,t!==m["k"].PRINTER.code){e.next=5;break}return this.uniqueNameFlag=!0,this.uniqueNameMessage="",e.abrupt("return",!1);case 5:if(n=this.switchNameRules(),n){e.next=8;break}return e.abrupt("return",!1);case 8:return e.next=10,this.validUniqueRes({propName:"name",propVal:this.editModal.name,id:this.editModal.id,moduleName:c["e"].Device});case 10:i=e.sent,a=i.uniqueFlag,r=i.uniqueMessage,this.uniqueNameMessage=r,this.uniqueNameFlag=a;case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),uniqueIdValid:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.validUnique({propName:"code",propVal:this.editModal.code,id:this.editModal.id,moduleName:c["e"].Device},t);case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),checkNameUnique:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.validUnique({propName:"name",propVal:this.editModal.name,id:this.editModal.id,moduleName:c["e"].Device},t);case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),getAssociateStation:function(e){for(var t=e&&e.length||0,n={connect:[]},i=0;i<t;i++)n.connect.push({id:e[i].id});return n},add:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,i,a,r,o,c,d,l,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$refs.editModalForm.validate();case 2:if(t=e.sent,t){e.next=5;break}return e.abrupt("return",!1);case 5:return n=this.editModal,i=n.code,a=n.name,r=n.deviceType,o=n.address,c=n.workStation,d=n.status,l=n.description,u=this.getAssociateStation(c),e.next=9,s["create"]({code:i,name:a,deviceType:r,address:o,workStation:u,status:d,description:l});case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getAssociateUpdateStation:function(e){for(var t=[],n=[],i=this.bakItem&&this.bakItem.workStation,a=function(n){-1===e.findIndex((function(e){return e.id===i[n].id}))&&t.push({id:i[n].id})},r=0;r<i.length;r++)a(r);for(var o=function(t){-1===i.findIndex((function(n){return n.id===e[t].id}))&&n.push({id:e[t].id})},s=0;s<e.length;s++)o(s);return{disconnect:t,connect:n}},edit:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n,i,a,r,o,c,d,l,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$refs.editModalForm.validate();case 2:if(t=e.sent,t){e.next=5;break}return e.abrupt("return",!1);case 5:return n=this.editModal,i=n.id,a=n.name,r=n.deviceType,o=n.address,c=n.workStation,d=n.status,l=n.description,u=this.getAssociateUpdateStation(c),e.next=9,s["update"]({where:{id:i},data:{name:a,deviceType:r,address:o,status:d,workStation:{connect:u.connect,disconnect:u.disconnect},description:l}});case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),cancel:function(){this.$refs.editModal.close(),this.$emit("cancel")}}},v=f,b=n("2877"),g=Object(b["a"])(v,i,a,!1,null,null,null);t["default"]=g.exports}}]);